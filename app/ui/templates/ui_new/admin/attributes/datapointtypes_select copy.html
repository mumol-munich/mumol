<div class="card">
    <div class="card-header d-flex">
        <div>
            Datapoint Types
        </div>
        <div class="ml-auto">
            <input type="checkbox" class="custom-control-input custom-rcmd-switch" id="custom_datapointtype_rcmd_switch">
            <label class="custom-control-label" for="custom_datapointtype_rcmd_switch">Recommended</label>
        </div>
    </div>
    <div class="card-body">
        <ul class="list-group overflow-auto" id="custom_datapointtypes_li" style="height:200px;">
            {% for dpt in datapointtypes %}
            <li class="list-group-item d-inline" data-dpt_rcmds="{{dpt.rcmd_methods__id}}">
                <button type="button" class="custom-dpt-add-btn custom-button-outline-color5 mr-1" data-dpt_pk="{{dpt.pk}}">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <span data-dpt_pk="{{dpt.pk}}" data-options="{{dpt.options}}" data-toggle="tooltip" title="{{dpt.helptext}}">{{dpt.name}}</span>
            </li>
            {% endfor %}
        </ul>
    </div>
    <div class="card-footer">
        <button type="button" class="btn btn-link btn-block" data-toggle="modal" data-target="#add_datapointtype"><i class="fas fa-plus"></i> New Datapoint</button>
    </div>
</div>


<script type="text/javascript">
$(document).ready(function(){

    $("#custom_datapointtype_rcmd_switch").on("click", function(){
        
        if($(this).prop("checked")){
            $("#custom_datapointtypes_li li").each(function(i, val){
                x = val;
                var rcmd_methods = $(val).attr("data-dpt_rcmds").split(',');
                if(rcmd_methods.indexOf($("#id_method").val()) > -1) {
                    $(val).find("*").show();
                } else {
                    $(val).find("*").hide();
                }
            });
        } else {
            $("#custom_datapointtypes_li li").each(function(i, val){
                $(val).find("*").show();
            });
        }

    });
    
    // $("#custom_datapointtype_rcmd_switch").on("click", function(){
    //     if($(this).prop("checked")){

    //         console.log("HI");

    //         $("#custom_datapointtypes_li li").each(function(i, val){
    //             if(JSON.parse($(val).attr("data-dpt_rcmds")).indexOf(Number($("#id_method").val())) > -1) {
    //                 $(val).find("*").show();
    //             } else {
    //                 $(val).find("*").hide();
    //             }
    //         });

    //     } else {
    //         $("#custom_datapointtypes_li li").find("*").show();
    //     }
    // });

});

</script>